{% extends "base.html" %}

{% block title %}Home - SoulBloom{% endblock %}

{% block content %}
<main>
  <div class="chat-container">
    <h1>ðŸŒ¸ SoulBloom Chatbot</h1>
    <div id="chat-box" class="chat-box"></div>
    <div class="input-area">
      <input type="text" id="userInput" placeholder="Type your message..." />
      <button onclick="sendMessage()">Send</button>
    </div>
  </div>

  <script>
    async function sendMessage() {
      const input = document.getElementById("userInput");
      const message = input.value.trim();
      if (!message) return;

      // Show user message
      const chatBox = document.getElementById("chat-box");
      chatBox.innerHTML += `<div class="user">You: ${message}</div>`;

      // Call backend API
      let response = await fetch("/api/chat", {   // âœ… relative path use karo
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ message })
      });

      let data = await response.json();

      // Show bot reply
      chatBox.innerHTML += `<div class="bot">Bot: ${data.reply}</div>`;

      input.value = "";
      chatBox.scrollTop = chatBox.scrollHeight;
    }
  </script>
</main>
{% endblock %}